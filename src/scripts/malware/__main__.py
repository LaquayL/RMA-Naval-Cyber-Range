import sys
import settings

import asyncio
import logging
import setproctitle

from cc_over_ws import command_and_control
from nmea import listen_nmea

async def main():
  setproctitle.setproctitle("I_c0ntro1_y0ur_5hip")
  print(f"Running in {settings.MODE} mode")
  print("Will bind nmea to:", settings.LISTEN_INTERFACE)
  print("Target:", settings.TARGET)
  await asyncio.gather(
    listen_nmea(),
    command_and_control(),
  )

if __name__ == '__main__':
  logging.basicConfig(level = logging.DEBUG)
  asyncio.run(main())
